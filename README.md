# React で入力フォームをリストとして表示する場合のレンダリングのパフォーマンス向上方法

## 問題点

- 入力フォームの値を配列として State で管理して入力フォームの値が変更された時のハンドラーを共通化した場合、ハンドラーは配列に依存するため Object.is()での比較が常に false になり入力のたびに再計算される
- ハンドラーが再計算されるとハンドラーに依存する共通のリスト要素のコンポーネントが再レンダリングされてしまう
- 値の変更がなかったフォームも 1 文字入力するたびに再レンダリングされてしまうため入力が遅くなるなどパフォーマンスに悪影響を及ぼす
- 単純にハンドラーの変更を無視するように変更すると他のフォームのハンドラーが参照する State は古い状態のものなので他のフォームで入力時に古い State をもとに値が更新されて再レンダリングされてしまう

## 解決策

- 入力フォームのフォーカス状態を別途 State として管理する
- 共通のリスト要素のコンポーネントをメモ化してハンドラーの変更があった場合に再レンダリングされないように React.memo の第二引数の比較処理をカスタマイズしてハンドラーの判定を除外する
- フォーカス状態に変更があった場合は共通のリスト要素のコンポーネントを再レンダリングすることでハンドラーから最新の State を参照できるようにする
